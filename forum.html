<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Formulário de Post</title>
</head>
<body>
  <header>
    <h1>Adicionar Novo Post</h1>
  </header>

  <main>
    <form id="postForm">
      <label for="titulo">Título:</label>
      <input type="text" id="titulo" name="titulo" required /><br/><br/>

      <label for="resumo">Resumo:</label>
      <textarea id="resumo" name="resumo" required></textarea><br/><br/>

      <label for="aprendizados">Aprendizados:</label>
      <textarea id="aprendizados" name="aprendizados" required></textarea><br/><br/>

      <label for="ferramentas">Ferramentas Utilizadas:</label>
      <textarea id="ferramentas" name="ferramentas" required></textarea><br/><br/>

      <label for="convite">Convite:</label>
      <textarea id="convite" name="convite" required></textarea><br/><br/>

      <button type="submit">Adicionar Post</button>
    </form>

    <h2>Posts Salvos (no LocalStorage)</h2>
    <ul id="postList"></ul>

    <button id="downloadJson">Baixar JSON</button>
  </main>

  <footer>
    <a href="index.html">← Voltar para o Início</a>
  </footer>

  <script>
    // Função para carregar e exibir os posts salvos no LocalStorage
    function carregarPosts() {
      const posts = JSON.parse(localStorage.getItem('posts')) || [];
      const postList = document.getElementById('postList');
      postList.innerHTML = '';
      posts.forEach(post => {
        const li = document.createElement('li');
        li.innerHTML = `<strong>${post.titulo}</strong><br><small>${post.resumo}</small>`;
        postList.appendChild(li);
      });
    }

    // Função para adicionar post ao LocalStorage
    document.getElementById('postForm').addEventListener('submit', function (event) {
      event.preventDefault();

      const titulo = document.getElementById('titulo').value;
      const resumo = document.getElementById('resumo').value;
      const aprendizados = document.getElementById('aprendizados').value.split('\n');
      const ferramentas = document.getElementById('ferramentas').value.split('\n');
      const convite = document.getElementById('convite').value;

      // Cria um novo post com estrutura JSON
      const novoPost = {
        titulo,
        resumo,
        aprendizados,
        ferramentas,
        convite,
        dataCriacao: new Date().toLocaleString()
      };

      // Carrega os posts existentes do LocalStorage
      const posts = JSON.parse(localStorage.getItem('posts')) || [];

      // Adiciona o novo post à lista
      posts.push(novoPost);

      // Salva a lista atualizada no LocalStorage
      localStorage.setItem('posts', JSON.stringify(posts));

      // Limpa o formulário
      document.getElementById('postForm').reset();

      // Recarrega e exibe os posts
      carregarPosts();
    });

    // Função para baixar o arquivo JSON com os posts do LocalStorage
    document.getElementById('downloadJson').addEventListener('click', function () {
      const posts = JSON.parse(localStorage.getItem('posts')) || [];

      // Cria um arquivo JSON a partir dos dados
      const jsonBlob = new Blob([JSON.stringify(posts, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(jsonBlob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'posts.json';
      link.click();
      URL.revokeObjectURL(url);
    });

    // Carregar os posts ao carregar a página
    carregarPosts();
  </script>
</body>
</html>
